l_ciBar() +
theme(axis.text=element_text(size=18),
axis.title=element_text(size=20,face="bold"))
theme_get()
fig6 =paste("G:/My Drive/GofAK_TPWS_metadataReduced/SeasonalityAnalysis/",site,'/',site,"GAM1_Males.png",sep="")
ggsave(fig6)
#second way to plot GAM
vizGG2 = plot(viz, allTerms = T) +
l_fitLine(colour = "red") + l_rug(mapping = aes(x=x,y=y), alpha=0.8) +
labs(title = 'Males (GAM)')+
l_ciLine(mul = 5, colour = "blue", linetype = 2)+
l_points(shape = 19, size = 1, alpha = 0.1) + theme_classic()
print(vizGG2,pages =1)
fig7 =paste("G:/My Drive/GofAK_TPWS_metadataReduced/SeasonalityAnalysis/",site,'/',site,"GAM2_Males.png",sep="")
ggsave(fig7)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
knitr::opts_chunk$set(echo = TRUE)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(dggridR)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(dggridR)
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
library(dggridR)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(dggridR)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0,-119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1  -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1 -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34,
-119.4 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34, -119.4 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1 -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.4, 34.1 -119.4, 34.1 -119.4, 34 -119.4, 34.0 -119.4)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34.0, -119.4 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.4 34.0, -119.4 34.1, -119.4 34.1, -119.4 34.0, -119.4 34.0))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-120.58357239 34.20654297, -118.90743256 33.36573029))")
occurence("Pterois volitans")
ptevol <- occurrence("Pterois volitans")
View(ptevol)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.41, 34.08 -119.41, 34.08 -119.36, 34.0 -119.36, 34.01 -119.36)) ")
(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))")
geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))
""
""
geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))"
view(geometry)
View(geometry)
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((34.0 -119.41, 34.08 -119.41, 34.08 -119.36, 34.0 -119.36, 34.01 -119.36)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-120.58357239 34.20654297, -118.90743256 33.36573029))")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-70.2 43.5, -69.8 43.5, -69.8 43.9, -70.2 43.9, -70.2 43.5)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0, -119.36 34.01)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-120.58357239 34.20654297, -118.90743256 33.36573029)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.0)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.006, -119.41 34.08, -119.36 34.08, -119.36 34.006, -119.36 34.01)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.006, -119.41 34.0)) ")
View(SpeciesOccurence)
View(SpeciesOccurece)
View(SpeciesOccurence)
leafletmap(SpeciesOccurence)
install.packages("leaflet")
library(leafletmap)
library(leaflet)
leafletmap(SpeciesOccurence)
leafletmap(SpeciesOccurence)
library(leaflet)
leafletmap(SpeciesOccurence)
leaflet(SpeciesOccurence)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83, -117.32 32.83)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
library(leaflet)
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83, -117.32 32.83)) ")
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83)) ")
#loading robis
installed <- rownames(installed.packages())
if ( !("robis" %in% installed) ){
if ( !("remotes" %in% installed) )install.packages("remotes")
remotes::install_github("iobis/robis")
}
#load libraries
library(robis)
library('ggplot2')
library("rnaturalearth")
library("rnaturalearthdata")
library(roperators)
library(dplyr)
library(magrittr)
library(vegan)
library(leaflet)
x = data.frame(lat = c("32°49.573", "32°47.945",  "32°47.945", "32°49.573", "32°49.573"),
lon = c("-117°19.000", "-117°20.528", "-117°20.068", "-117°19.000", "-117°19.000"))
x$lat = gsub('°', ' ', x$lat)
x$lon = gsub('°', ' ', x$lon)
#convert from decimalminute to decimal degree
x$latdec = measurements::conv_unit(x$lat, from = 'deg_dec_min', to = 'dec_deg')
install.packages("measurements")
library(measurements)
x = data.frame(lat = c("32°49.573", "32°47.945",  "32°47.945", "32°49.573", "32°49.573"),
lon = c("-117°19.000", "-117°20.528", "-117°20.068", "-117°19.000", "-117°19.000"))
x$lat = gsub('°', ' ', x$lat)
x$lon = gsub('°', ' ', x$lon)
#convert from decimalminute to decimal degree
x$latdec = measurements::conv_unit(x$lat, from = 'deg_dec_min', to = 'dec_deg')
x$londec = measurements::conv_unit(x$lon, from = 'deg_dec_min', to = 'dec_deg')
SpeciesOccurence <- occurrence(geometry = "POLYGON ((-119.41 34.0, -119.41 34.08, -119.36 34.08, -119.36 34.006, -119.41 34.0)) ")
# <- occurrence(geometry = "POLYGON ((-117.32 32.83, -117.34 32.83, -117.33 32.80, -117.32 32.80, -117.32 32.83)) ")
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
install.packages("OpenStreetMap")
PATH="${RTOOLS40_HOME}\usr\bin;${PATH}"
writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
install.packages("OpenStreetMap")
Sys.which("make")
install.packages("OpenStreetMap")
install.packages("blackbox")
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
setwd("~/GitHub/WAT_HabMod")
install.packages("OpenStreetMap")
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
EastCoastMap = openmap(c(-80,-65),c(31,43))
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
install.packages("OpenStreetMap")
install.packages("OpenStreetMap")
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
library(OpenStreetMap)
#load files
ChlA = nc_open("erdMH1chlamday_8b69_53f4_fca7.nc")
names(ChlA$var)
v1=ChlA$var[[1]]
ChlAvar=ncvar_get(ChlA,v1)
ChlA_lon=v1$dim[[1]]$vals
ChlA_lat=v1$dim[[2]]$vals
dates=as.POSIXlt(v1$dim[[3]]$vals,origin='1970-01-01',tz='GMT')
#plotting all values greater than 2, as 2
ChlAvar[ChlAvar > 2] = 2
#adding land mass
EastCoastMap = openmap(c(-80,-65),c(31,43))
install.packages("lubridate")
install.packages("ggplot2")
install.packages("data.table")
p <- ggmap(get_googlemap(center = c(lon = -122.335167, lat = 47.608013),
zoom = 11, scale = 2,
maptype ='terrain',
color = 'color'))
library(ncdf4)
library(httr)
library (naniar)
library(ggmap)
p <- ggmap(get_googlemap(center = c(lon = -122.335167, lat = 47.608013),
zoom = 11, scale = 2,
maptype ='terrain',
color = 'color'))
AIzaSyAw3Nscr00ju-LKWUueSWk3y7m5cbWziSQ
ggmap::register_google(key = "AIzaSyAw3Nscr00ju-LKWUueSWk3y7m5cbWziSQ")
p <- ggmap(get_googlemap(center = c(lon = -122.335167, lat = 47.608013),
zoom = 11, scale = 2,
maptype ='terrain',
color = 'color'))
p
ggmap(get_googlemap(center = c(lon = -122.335167, lat = 47.608013),
+                          zoom = 11, scale = 2,
+                          maptype ='terrain',
+                          color = 'color'))
ggmap(get_googlemap(center = c(lon = -122.335167, lat = 47.608013),+zoom = 11, scale = 2,+ maptype ='terrain',+color = 'color'))
ggmap(get_googlemap(center = c(lon = -122.335167, lat = 47.608013),zoom = 11, scale = 2,maptype ='terrain',color = 'color'))
ggplot(data = world) +
geom_sf()
world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)
library(ggmap)
library("rnaturalearth")
library("rnaturalearthdata")
world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)
ggplot(data = world) +
geom_sf()
library(ncdf4)
library(httr)
library(sf)
library(dplyr)
library(ncdf)
library(raster)
#load files
SST = nc_open("erdMH1sstdmdayR20190SQ_db9b_1c36_0a7f.nc")
names(SST$var)
v1=SST$var[[1]]
SSTvar=ncvar_get(SST,v1)
SST_lon=v1$dim[[1]]$vals
SST_lat=v1$dim[[2]]$vals
dates=as.POSIXlt(v1$dim[[3]]$vals,origin='1970-01-01',tz='GMT')
#creating maps
#setting color breaks
h=hist(SSTvar[,,1],100,plot=FALSE)
breaks=h$breaks
n=length(breaks)-1
jet.colors <-colorRampPalette(c("blue", "#007FFF", "cyan","#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
c=jet.colors(n)
#begin plot
layout(matrix(c(1,2,3,0,4,0), nrow=1, ncol=2), widths=c(5,1), heights=4)
layout.show(2)
par(mar=c(3,3,3,1))
r = raster(t(SSTvar[,,1]),xmn = min(SST_lon),xmx = max(SST_lon),ymn=min(SST_lat),ymx=max(SST_lat))
image(r,col=c,breaks=breaks,xlab='',ylab='',axes=TRUE,xlim = c(min(SST_lon),max(SST_lon)),xaxs='i',asp=0, main=paste("Monthly SST", dates[1]))
points(-66.35, rep(41.06165),pch=20,cex=2)
points(-76, rep(33.6699),pch=20,cex=2)
#adding color scale
par(mar=c(3,1,3,3))
source('scale.R')
image.scale(sst[,,1], col=c, breaks=breaks, horiz=FALSE, yaxt="n",xlab='',ylab='',main='SST')
axis(4, las=1)
box()
ggplot(data - world)+geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
ggplot(data =world)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
h=hist(ChlAvar[,,1],100,plot=FALSE)
breaks=h$breaks
n=length(breaks)-1
jet.colors <-colorRampPalette(c("blue", "#007FFF", "cyan","#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
c=jet.colors(n)
layout(matrix(c(1,2,3,0,4,0), nrow=1, ncol=2), widths=c(5,1), heights=4)
layout.show(2)
par(mar=c(3,3,3,1))
ggplot(data =world)+gome_raster(data = r)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
ggplot(data =world)+geom_raster(data = r)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
points(-66.35, rep(41.06165),pch=20,cex=1)
points(-76, rep(33.6699),pch=20,cex=2)
points = rasterToPoints(r, spatial = TRUE)
df = data.frame(points)
rm(points,df)
df = data.frame(points)
ggplot() +
geom_raster(data = df , aes(x = x, y = y, fill = SST)) +
ggtitle("Continuous Elevation Map - NEON Harvard Forest Field Site")
View(df)
points
r = raster(t(ChlAvar[,,1]),xmn = min(ChlA_lon),xmx = max(ChlA_lon),ymn=min(ChlA_lat),ymx=max(ChlA_lat))
points = rasterToPoints(r, spatial = TRUE)
df = data.frame(points)
View(points)
df = data.frame(points)
View(df)
ggplot() +
geom_raster(data = DSM_HARV_df , aes(x = x, y = y, fill = layer)) +
ggtitle("Continuous Elevation Map - NEON Harvard Forest Field Site")
ggplot() +
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle("Continuous Elevation Map - NEON Harvard Forest Field Site")
points = rasterToPoints(r, spatial = TRUE)
df = data.frame(points)
ggplot(data =world)+geom_raster(data = r, x=)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
image.scale(sst[,,1], col=c, breaks=breaks, horiz=FALSE, yaxt="n",xlab='',ylab='',main='Chl a')
ggplot(data =world)+geom_raster(data = r, x=)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
image.scale(sst[,,1], col=c, breaks=breaks, horiz=FALSE, yaxt="n",xlab='',ylab='',main='Chl a')
ggplot(data =world)+geom_raster(data = r, x=)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
ggplot() +
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+
geom_raster(data = world)+
geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))
HZ = points(-66.35, rep(41.06165),pch=20,cex=1)
GS = points(-76, rep(33.6699),pch=20,cex=2)
HZ
HZ = c(-66.35,41.06165)
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(data = HZ)
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=5)
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="red")
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
View(df)
names(df)[names(df)=="Layer"]="Chl A"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
View(df)
names(df)[names(df)=="Layer"]="Chl A"
View(df)
names(df)[names(df)=="Chl A"]="Layer"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
View(df)
names(df)[names(df)=="Chl A"]="layer"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
df = data.frame(points)
names(df)[names(df)=="layer"]="Chl a"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = layer)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
View(df)
names(df)[names(df)=="layer"]="Chl a"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = Chl a)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
names(df)[names(df)=="layer"]="Chla"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = Chla)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
View(df)
names(df)[names(df)=="Chl a"]="Chla"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = Chla)) +
ggtitle(paste("Monthly Chl A", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="green")
library(ncdf4)
library(httr)
library(sf)
library(dplyr)
library(ncdf)
library(raster)
#load files
SST = nc_open("erdMH1sstdmdayR20190SQ_db9b_1c36_0a7f.nc")
names(SST$var)
v1=SST$var[[1]]
SSTvar=ncvar_get(SST,v1)
SST_lon=v1$dim[[1]]$vals
SST_lat=v1$dim[[2]]$vals
dates=as.POSIXlt(v1$dim[[3]]$vals,origin='1970-01-01',tz='GMT')
#setting color breaks
h=hist(SSTvar[,,1],100,plot=FALSE)
breaks=h$breaks
n=length(breaks)-1
jet.colors <-colorRampPalette(c("blue", "#007FFF", "cyan","#7FFF7F", "yellow", "#FF7F00", "red", "#7F0000"))
c=jet.colors(n)
#plotting in base R
layout(matrix(c(1,2,3,0,4,0), nrow=1, ncol=2), widths=c(5,1), heights=4)
layout.show(2)
par(mar=c(3,3,3,1))
r = raster(t(SSTvar[,,1]),xmn = min(SST_lon),xmx = max(SST_lon),ymn=min(SST_lat),ymx=max(SST_lat))
image(r,col=c,breaks=breaks,xlab='',ylab='',axes=TRUE,xlim = c(min(SST_lon),max(SST_lon)),xaxs='i',asp=0, main=paste("Monthly SST", dates[1]))
points(-66.35, rep(41.06165),pch=20,cex=2)
points(-76, rep(33.6699),pch=20,cex=2)
#adding color scale
par(mar=c(3,1,3,3))
source('scale.R')
image.scale(sst[,,1], col=c, breaks=breaks, horiz=FALSE, yaxt="n",xlab='',ylab='',main='SST')
axis(4, las=1)
box()
#plotting in ggplot
points = rasterToPoints(r, spatial = TRUE)
df = data.frame(points)
View(df)
names(df)[names(df)=="layer"]="SST"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = SST)) +
ggtitle(paste("SST", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="red")
names(df)[names(df)=="layer"]="SST"
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = SST)) +
ggtitle(paste("SST", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="red")
world <- ne_countries(scale = "medium", returnclass = "sf")
class(world)
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = SST)) +
ggtitle(paste("SST", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "red",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="red")
ggplot(data=world) +  geom_sf()+coord_sf(xlim= c(-81,-65),ylim=c(31,43),expand=FALSE)+
geom_raster(data = df , aes(x = x, y = y, fill = SST)) +
ggtitle(paste("SST", dates[1]))+geom_point(x = -66.3, y = 41.1, color = "black",size=3)+
geom_point(x=-76, y=33.69, color = "green",size = 3)+xlab("Latitude")+ylab("Longitude")+
scale_fill_gradient(low="blue", high="red")
